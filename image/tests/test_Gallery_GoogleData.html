<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<title>Testing the Image Gallery</title>

	<!-- required: a default theme file -->
	<link rel="stylesheet" id="themeStyles" href="../../../dijit/themes/tundra/tundra.css">
	<link rel="stylesheet" href="../resources/image.css">

	<style type="text/css">
		@import "../../../dijit/tests/css/dijitTests.css";
	</style>

</head>
<body class="tundra">
	<h1 class="testTitle">dojox/image/Gallery</h1>

	<h2>From GoogleImageSearchStore:</h2>

	<button id="changeStoreButton">Change Datastore</button>

	<div id="gallery1" data-dojo-type="dojox/image/Gallery" data-dojo-props="imageWidth: 700, imageHeight: 500, imageThumbAttr: 'tbUrl', imageLargeAttr:'unescapedUrl', titleAttr: 'titleNoFormatting'"></div>

	<!-- required: dojo.js -->
	<script src="../../../dojo/dojo.js" data-dojo-config="isDebug:1, async: 1"></script>

	<!-- do not use! only for testing dynamic themes -->
	<script src="../../../dijit/tests/_testCommon.js"></script>

	<script>
		require([
			"dojo/parser",
			"dojox/data/GoogleSearchStore",
			"dojo/dom",
			"dojo/on",
			"dijit/registry",
			"dojox/data/FlickrRestStore",
			"dojox/image/Gallery",
			"dojo/domReady!"
		], function(
			parser,
			GoogleSearchStore,
			dom,
			on,
			registry,
			FlickrRestStore
		){
			parser.parse();

			var googleImageStore = new GoogleSearchStore.ImageSearch();
			var req = {
				query: {
					text: "kinsale"
				},
				count: 32
			};
			// testCommon defers parsing by a little, so Dijit's aren't ready
			// in addOnLoad for soria/nihilo :(
			setTimeout(function(){
				registry.byId("gallery1").setDataStore(googleImageStore, req);
			},250);

			function changeStore(){
				var flickrRestStore = new FlickrRestStore();
				var req = {
					query: {
						userid: "44153025@N00",
						apikey: "8c6803164dbc395fb7131c9d54843627",
						sort: [
							{
								attribute: "interestingness",
								descending: true
							}
						],
						tag_mode: "any"
					},
					count: 20
				};
				registry.byId("gallery1").setDataStore(flickrRestStore, req, {
				  imageThumbAttr: "imageUrlThumb",
				  imageLargeAttr: "imageUrl",
				  titleAttr: "title"

				});
			}
			on(dom.byId("changeStoreButton"), "click", changeStore);
		});
	</script>

</body>
</html>
